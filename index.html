<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç©ºç©ºå†°ç®± - æ¸©æš–é£Ÿè°±</title>
    <style>
        :root { 
            --primary-yellow: #ffb900; 
            --warm-white: #fffaf0;
            --deep-brown: #5d4037;
        }

        body { 
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; 
            background-color: var(--warm-white);
            /* æ¼‚æµ®é£Ÿç‰©èƒŒæ™¯ */
            background-image: url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffb900' fill-opacity='0.08'%3E%3Ctext x='10' y='20' font-size='15'%3EğŸ…%3C/text%3E%3Ctext x='50' y='30' font-size='15'%3EğŸ³%3C/text%3E%3Ctext x='30' y='60' font-size='15'%3EğŸ¥¬%3C/text%3E%3Ctext x='60' y='70' font-size='15'%3EğŸ—%3C/text%3E%3C/g%3E%3C/svg%3E");
            display: flex; 
            justify-content: center; 
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(8px);
            padding: 40px 30px; 
            border-radius: 30px; 
            box-shadow: 0 20px 40px rgba(255, 185, 0, 0.1); 
            width: 90%; 
            max-width: 450px; 
            border: 2px solid #ffecb3;
            text-align: center;
        }

        h1 { color: var(--deep-brown); margin-bottom: 5px; font-size: 28px; }
        .subtitle { color: #9e9e9e; margin-bottom: 30px; font-size: 14px; }

        textarea { 
            width: 100%; padding: 20px; border: 2px solid #ffe082; 
            border-radius: 20px; box-sizing: border-box; outline: none; 
            background-color: #fffdf7; font-size: 16px; transition: 0.3s;
            resize: none; color: var(--deep-brown);
        }
        textarea:focus { border-color: var(--primary-yellow); box-shadow: 0 0 10px rgba(255, 185, 0, 0.2); }

        button { 
            width: 100%; background: var(--primary-yellow); 
            color: white; border: none; padding: 18px; 
            border-radius: 50px; margin-top: 20px; 
            cursor: pointer; font-size: 18px; font-weight: bold; 
            box-shadow: 0 8px 20px rgba(255, 185, 0, 0.3);
            transition: 0.3s;
        }
        button:hover { transform: translateY(-2px); background: #ffa000; }
        button:disabled { background: #ccc; box-shadow: none; }

        .loading { display: none; margin-top: 20px; color: var(--primary-yellow); font-weight: bold; }

        #result-area { 
            margin-top: 30px; padding: 25px; background: #fffde7; 
            border-radius: 20px; border: 1px dashed #ffd54f;
            color: var(--deep-brown); display: none; 
            text-align: left; line-height: 1.8; white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›’ ç©ºç©ºå†°ç®±</h1>
        <div class="subtitle">è®©å‰©ä¸‹çš„é£Ÿæéƒ½è¿›ç›˜å­</div>
        
        <textarea id="ingredients" rows="3" placeholder="å†°ç®±é‡Œè¿˜å‰©ä»€ä¹ˆï¼Ÿæ¯”å¦‚ï¼šåŠä¸ªæ´‹è‘±ã€ä¸¤ä¸ªé¸¡è›‹..."></textarea>
        <button id="submit-btn" onclick="generateRecipe()">å¸®æˆ‘åŠ å·¥ï¼</button>

        <div id="loading" class="loading">ğŸ‘¨â€ğŸ³ å¤§å¨æ­£åœ¨çœ‹é£Ÿæï¼Œæ„æ€èœè°±ä¸­...</div>
        <div id="result-area"></div>
    </div>

    <script>
        async function generateRecipe() {
            const ingredientsInput = document.getElementById('ingredients');
            const btn = document.getElementById('submit-btn');
            const resultArea = document.getElementById('result-area');
            const loading = document.getElementById('loading');

            if (!ingredientsInput.value.trim()) { alert('è¯·è¾“å…¥é£Ÿæå“¦ï¼'); return; }

            // --- æ ¸å¿ƒé…ç½® ---
            const apiUrl = '/api/chat'; 

            // çŠ¶æ€åˆ‡æ¢
            btn.disabled = true;
            loading.style.display = 'block';
            resultArea.style.display = 'none';

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json', 
                    },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [
                            { role: "system", content: "ä½ æ˜¯ä¸€ä½ç²¾é€šâ€˜æ¸…å†°ç®±â€™çš„æš–å¿ƒå¤§å¨ï¼Œæ“…é•¿ç”¨æœ‰é™é£Ÿæåˆ›é€ ç¾å‘³ã€‚è¯·ç»™å‡ºèœåã€ç”¨æ–™å’Œç®€å•çš„æ­¥éª¤ã€‚" },
                            { role: "user", content: `æˆ‘æœ‰è¿™äº›é£Ÿæï¼š${ingredientsInput.value}ã€‚è¯·å¸®æˆ‘è®¾è®¡ä¸€ä¸ªç®€å•å¥½åƒçš„èœè°±ã€‚` }
                        ]
                    })
                });

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }

                resultArea.innerText = data.choices[0].message.content;
                resultArea.style.display = 'block';
            } catch (error) {
                console.error(error);
                alert('å¤§å¨é—¹æƒ…ç»ªäº†ï¼š' + error.message);
            } finally {
                btn.disabled = false;
                loading.style.display = 'none';
            }
        }
    </script>
</body>
</html>
